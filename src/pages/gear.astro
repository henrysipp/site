---
import { getCollection } from 'astro:content';
import SidebarLayout from '../layouts/SidebarLayout.astro';
import Heading from '../components/Heading.astro';
import Subheading from '../components/Subheading.astro';
import HorizontalScroller from '../components/HorizontalScroller.astro';

const allGear = await getCollection('gear');

const recentGear = [...allGear]
	.filter(item => item.data.addedDate)
	.sort((a, b) => (b.data.addedDate?.getTime() || 0) - (a.data.addedDate?.getTime() || 0))
	.slice(0, 6);

const workspaceGear = allGear.filter(item => item.data.tags.includes('workspace'));
const dailyCarryGear = allGear.filter(item => item.data.tags.includes('daily carry'));
const techGear = allGear.filter(item => item.data.tags.includes('tech'));
const homeGear = allGear.filter(item => item.data.tags.includes('home'));
const softwareGear = allGear.filter(item => item.data.tags.includes('software'));
---

<SidebarLayout title="Gear" description="The tools and equipment I use">
	<Heading>Gear</Heading>
	<Subheading class="mt-2">Things I use and like</Subheading>

	<div class="mt-12 space-y-12">
		<!-- Recently Added Section -->
		{recentGear.length > 0 && (
			<section>
				<h2 class="text-xl font-semibold mb-4 text-secondary">Recently Added</h2>
				<HorizontalScroller>
					{recentGear.map((item) => (
						<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
							<div class="rounded-lg overflow-hidden">
								<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
								<div class="py-2">
									<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
								</div>
							</div>
						</a>
					))}
				</HorizontalScroller>
			</section>
		)}

		<!-- Home Section -->
		{homeGear.length > 0 && (
			<section>
				<h2 class="text-xl font-semibold mb-4 text-secondary">Home</h2>
				<HorizontalScroller>
					{homeGear.map((item) => (
						<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
							<div class="rounded-lg overflow-hidden">
								<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
								<div class="py-2">
									<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
								</div>
							</div>
						</a>
					))}
				</HorizontalScroller>
			</section>
		)}

		<!-- Software Section -->
		{softwareGear.length > 0 && (
			<section>
				<h2 class="text-xl font-semibold mb-4 text-secondary">Software</h2>
				<HorizontalScroller>
					{softwareGear.map((item) => (
						<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
							<div class="rounded-lg overflow-hidden">
								<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
								<div class="py-2">
									<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
								</div>
							</div>
						</a>
					))}
				</HorizontalScroller>
			</section>
		)}

		<!-- Workspace Section -->
		<section>
			<h2 class="text-xl font-semibold mb-4 text-secondary">Workspace</h2>
			<HorizontalScroller>
				{workspaceGear.map((item) => (
					<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
						<div class="rounded-lg overflow-hidden">
							<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
							<div class="py-2">
								<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
							</div>
						</div>
					</a>
				))}
			</HorizontalScroller>
		</section>

		<!-- Daily Carry Section -->
		<section>
			<h2 class="text-xl font-semibold mb-4 text-secondary">Daily Carry</h2>
			<HorizontalScroller>
				{dailyCarryGear.map((item) => (
					<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
						<div class="rounded-lg overflow-hidden">
							<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
							<div class="py-2">
								<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
							</div>
						</div>
					</a>
				))}
			</HorizontalScroller>
		</section>

		<!-- Tech Section -->
		<section>
			<h2 class="text-xl font-semibold mb-4 text-secondary">Tech</h2>
			<HorizontalScroller>
				{techGear.map((item) => (
					<a href={`/gear/${item.id}`} class="flex-none w-48 snap-start group">
						<div class="rounded-lg overflow-hidden">
							<img src={item.data.image} alt={item.data.title} class="aspect-square object-cover w-full rounded-lg" />
							<div class="py-2">
								<h3 class="font-semibold text-secondary group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">{item.data.title}</h3>
							</div>
						</div>
					</a>
				))}
			</HorizontalScroller>
		</section>
	</div>
</SidebarLayout>
